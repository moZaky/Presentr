<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Presentr - PowerPoint AutoFill (Offline)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .chart-preview {
            min-height: 200px;
            background: linear-gradient(45deg, #f0f0f0 25%, transparent 25%, transparent 75%, #f0f0f0 75%, #f0f0f0),
                        linear-gradient(45deg, #f0f0f0 25%, transparent 25%, transparent 75%, #f0f0f0 75%, #f0f0f0);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
        }
        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .file-drop-zone {
            border: 2px dashed #cbd5e0;
            transition: all 0.3s ease;
        }
        .file-drop-zone.dragover {
            border-color: #667eea;
            background-color: #f7fafc;
        }
        .progress-bar {
            transition: width 0.3s ease;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
    </style>
</head>
<body class="min-h-screen gradient-bg">
    <!-- Header -->
    <header class="glass-effect shadow-lg">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <div class="w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-800">Presentr</h1>
                </div>
                <div class="flex items-center space-x-4">
                    <span class="text-sm text-gray-600">Offline Mode</span>
                    <div class="w-2 h-2 bg-green-500 rounded-full animate-pulse"></div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-8">
        <div class="max-w-4xl mx-auto">
            <!-- Hero Section -->
            <div class="text-center mb-8 fade-in">
                <h2 class="text-4xl font-bold text-white mb-4">PowerPoint AutoFill</h2>
                <p class="text-xl text-gray-200 mb-8">Transform your Excel data into professional PowerPoint presentations with visual charts</p>
                <div class="flex justify-center space-x-4">
                    <div class="bg-white/20 backdrop-blur-sm rounded-lg px-4 py-2">
                        <span class="text-white font-semibold">‚úÖ No Server Required</span>
                    </div>
                    <div class="bg-white/20 backdrop-blur-sm rounded-lg px-4 py-2">
                        <span class="text-white font-semibold">üìä Visual Charts</span>
                    </div>
                    <div class="bg-white/20 backdrop-blur-sm rounded-lg px-4 py-2">
                        <span class="text-white font-semibold">üöÄ Instant Processing</span>
                    </div>
                </div>
            </div>

            <!-- Upload Section -->
            <div class="glass-effect rounded-2xl shadow-xl p-8 mb-8 fade-in">
                <h3 class="text-2xl font-semibold text-gray-800 mb-6">Upload Your Files</h3>
                
                <div class="grid md:grid-cols-2 gap-6">
                    <!-- PowerPoint Upload -->
                    <div class="space-y-4">
                        <label class="block text-sm font-medium text-gray-700">PowerPoint Template</label>
                        <div id="pptDropZone" class="file-drop-zone rounded-lg p-8 text-center cursor-pointer hover:bg-gray-50">
                            <svg class="w-12 h-12 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                            </svg>
                            <p class="text-gray-600 mb-2">Drop your PowerPoint file here</p>
                            <p class="text-sm text-gray-500">or click to browse</p>
                            <p class="text-xs text-gray-400 mt-2">.pptx files only</p>
                            <input type="file" id="pptInput" accept=".pptx" class="hidden">
                        </div>
                        <div id="pptFileName" class="text-sm text-gray-600 hidden">
                            <span class="font-medium">Selected:</span> <span id="pptName"></span>
                        </div>
                    </div>

                    <!-- Excel Upload -->
                    <div class="space-y-4">
                        <label class="block text-sm font-medium text-gray-700">Excel Data</label>
                        <div id="excelDropZone" class="file-drop-zone rounded-lg p-8 text-center cursor-pointer hover:bg-gray-50">
                            <svg class="w-12 h-12 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v1a1 1 0 001 1h4a1 1 0 001-1v-1m3-2V8a2 2 0 00-2-2H8a2 2 0 00-2 2v6m9 4h.01"></path>
                            </svg>
                            <p class="text-gray-600 mb-2">Drop your Excel file here</p>
                            <p class="text-sm text-gray-500">or click to browse</p>
                            <p class="text-xs text-gray-400 mt-2">.xlsx files only</p>
                            <input type="file" id="excelInput" accept=".xlsx" class="hidden">
                        </div>
                        <div id="excelFileName" class="text-sm text-gray-600 hidden">
                            <span class="font-medium">Selected:</span> <span id="excelName"></span>
                        </div>
                    </div>
                </div>

                <!-- Process Button -->
                <div class="mt-8 text-center">
                    <button id="processBtn" class="bg-gradient-to-r from-blue-500 to-purple-600 text-white px-8 py-3 rounded-lg font-semibold hover:from-blue-600 hover:to-purple-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed pulse" disabled>
                        <span id="processBtnText">Select Files to Process</span>
                        <div id="processLoader" class="loader inline-block ml-2 hidden"></div>
                    </button>
                </div>
            </div>

            <!-- Progress Section -->
            <div id="progressSection" class="glass-effect rounded-2xl shadow-xl p-8 mb-8 hidden">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">Processing Progress</h3>
                <div class="space-y-4">
                    <div class="flex items-center justify-between">
                        <span class="text-sm text-gray-600">Reading files...</span>
                        <span id="progressPercent" class="text-sm font-medium text-blue-600">0%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="progressBar" class="progress-bar bg-gradient-to-r from-blue-500 to-purple-600 h-2 rounded-full" style="width: 0%"></div>
                    </div>
                    <div id="progressStatus" class="text-sm text-gray-600">Initializing...</div>
                </div>
            </div>

            <!-- Results Section -->
            <div id="resultsSection" class="glass-effect rounded-2xl shadow-xl p-8 hidden">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">üéâ Processing Complete!</h3>
                <div class="bg-green-50 border border-green-200 rounded-lg p-4 mb-6">
                    <div class="flex items-center">
                        <svg class="w-5 h-5 text-green-500 mr-2" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                        </svg>
                        <span class="text-green-800">Your PowerPoint presentation has been generated successfully!</span>
                    </div>
                </div>
                
                <div class="grid md:grid-cols-2 gap-6 mb-6">
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-800 mb-2">Generated Slides</h4>
                        <div id="slideCount" class="text-2xl font-bold text-blue-600">7</div>
                        <div class="text-sm text-gray-600">Professional slides</div>
                    </div>
                    <div class="bg-gray-50 rounded-lg p-4">
                        <h4 class="font-medium text-gray-800 mb-2">Charts Created</h4>
                        <div id="chartCount" class="text-2xl font-bold text-purple-600">3</div>
                        <div class="text-sm text-gray-600">Visual charts</div>
                    </div>
                </div>

                <div class="text-center">
                    <button id="downloadBtn" class="bg-gradient-to-r from-green-500 to-emerald-600 text-white px-8 py-3 rounded-lg font-semibold hover:from-green-600 hover:to-emerald-700 transition-all duration-200">
                        <svg class="w-5 h-5 inline-block mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                        Download PowerPoint
                    </button>
                </div>
            </div>

            <!-- Sample Files Section -->
            <div class="glass-effect rounded-2xl shadow-xl p-8">
                <h3 class="text-xl font-semibold text-gray-800 mb-4">üìÅ Need Sample Files?</h3>
                <p class="text-gray-600 mb-6">Download sample files to test the application:</p>
                <div class="grid md:grid-cols-2 gap-4">
                    <button id="downloadSamplePPT" class="bg-white border border-gray-300 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors">
                        <div class="flex items-center">
                            <svg class="w-8 h-8 text-blue-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path>
                            </svg>
                            <div>
                                <div class="font-medium text-gray-800">Sample PowerPoint</div>
                                <div class="text-sm text-gray-600">Template with placeholders</div>
                            </div>
                        </div>
                    </button>
                    <button id="downloadSampleExcel" class="bg-white border border-gray-300 rounded-lg p-4 text-left hover:bg-gray-50 transition-colors">
                        <div class="flex items-center">
                            <svg class="w-8 h-8 text-green-500 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v1a1 1 0 001 1h4a1 1 0 001-1v-1m3-2V8a2 2 0 00-2-2H8a2 2 0 00-2 2v6m9 4h.01"></path>
                            </svg>
                            <div>
                                <div class="font-medium text-gray-800">Sample Excel Data</div>
                                <div class="text-sm text-gray-600">Data with chart information</div>
                            </div>
                        </div>
                    </button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="glass-effect mt-16">
        <div class="container mx-auto px-4 py-6">
            <div class="text-center text-gray-600">
                <p>Presentr - PowerPoint AutoFill | Works Completely Offline</p>
                <p class="text-sm mt-2">Transform your data into professional presentations instantly</p>
            </div>
        </div>
    </footer>

    <script>
        // Global variables
        let pptFile = null;
        let excelFile = null;
        let generatedPresentation = null;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            setupFileUpload();
            setupDragAndDrop();
            setupProcessButton();
            setupDownloadButtons();
            
            // Add fade-in animation to elements
            document.querySelectorAll('.fade-in').forEach((el, index) => {
                setTimeout(() => {
                    el.style.opacity = '1';
                }, index * 200);
            });
        });

        // File upload setup
        function setupFileUpload() {
            // PowerPoint upload
            const pptInput = document.getElementById('pptInput');
            const pptDropZone = document.getElementById('pptDropZone');
            const pptFileName = document.getElementById('pptFileName');
            const pptName = document.getElementById('pptName');

            pptDropZone.addEventListener('click', () => pptInput.click());
            
            pptInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file && file.name.endsWith('.pptx')) {
                    pptFile = file;
                    pptName.textContent = file.name;
                    pptFileName.classList.remove('hidden');
                    updateProcessButton();
                }
            });

            // Excel upload
            const excelInput = document.getElementById('excelInput');
            const excelDropZone = document.getElementById('excelDropZone');
            const excelFileName = document.getElementById('excelFileName');
            const excelName = document.getElementById('excelName');

            excelDropZone.addEventListener('click', () => excelInput.click());
            
            excelInput.addEventListener('change', (e) => {
                const file = e.target.files[0];
                if (file && file.name.endsWith('.xlsx')) {
                    excelFile = file;
                    excelName.textContent = file.name;
                    excelFileName.classList.remove('hidden');
                    updateProcessButton();
                }
            });
        }

        // Drag and drop setup
        function setupDragAndDrop() {
            const pptDropZone = document.getElementById('pptDropZone');
            const excelDropZone = document.getElementById('excelDropZone');

            [pptDropZone, excelDropZone].forEach(zone => {
                zone.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    zone.classList.add('dragover');
                });

                zone.addEventListener('dragleave', () => {
                    zone.classList.remove('dragover');
                });

                zone.addEventListener('drop', (e) => {
                    e.preventDefault();
                    zone.classList.remove('dragover');
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        const file = files[0];
                        const input = zone.querySelector('input[type="file"]');
                        
                        if (zone === pptDropZone && file.name.endsWith('.pptx')) {
                            pptFile = file;
                            document.getElementById('pptName').textContent = file.name;
                            document.getElementById('pptFileName').classList.remove('hidden');
                            updateProcessButton();
                        } else if (zone === excelDropZone && file.name.endsWith('.xlsx')) {
                            excelFile = file;
                            document.getElementById('excelName').textContent = file.name;
                            document.getElementById('excelFileName').classList.remove('hidden');
                            updateProcessButton();
                        }
                    }
                });
            });
        }

        // Update process button state
        function updateProcessButton() {
            const processBtn = document.getElementById('processBtn');
            const processBtnText = document.getElementById('processBtnText');
            
            if (pptFile && excelFile) {
                processBtn.disabled = false;
                processBtnText.textContent = 'Process Files';
            } else {
                processBtn.disabled = true;
                processBtnText.textContent = 'Select Files to Process';
            }
        }

        // Process button setup
        function setupProcessButton() {
            const processBtn = document.getElementById('processBtn');
            
            processBtn.addEventListener('click', async () => {
                if (pptFile && excelFile) {
                    await processFiles();
                }
            });
        }

        // Process files
        async function processFiles() {
            const progressSection = document.getElementById('progressSection');
            const progressBar = document.getElementById('progressBar');
            const progressPercent = document.getElementById('progressPercent');
            const progressStatus = document.getElementById('progressStatus');
            const processBtn = document.getElementById('processBtn');
            const processLoader = document.getElementById('processLoader');
            const processBtnText = document.getElementById('processBtnText');

            // Show progress
            progressSection.classList.remove('hidden');
            processBtn.disabled = true;
            processLoader.classList.remove('hidden');
            processBtnText.textContent = 'Processing...';

            try {
                // Step 1: Read Excel file
                updateProgress(20, 'Reading Excel data...');
                const excelData = await readExcelFile(excelFile);

                // Step 2: Read PowerPoint template
                updateProgress(40, 'Reading PowerPoint template...');
                const pptTemplate = await readPowerPointTemplate(pptFile);

                // Step 3: Process data and generate presentation
                updateProgress(60, 'Processing data and generating slides...');
                const presentation = await createSimplePresentation(excelData);

                // Step 4: Finalize presentation
                updateProgress(80, 'Finalizing presentation...');
                generatedPresentation = presentation;

                // Step 5: Complete
                updateProgress(100, 'Complete!');
                
                setTimeout(() => {
                    progressSection.classList.add('hidden');
                    document.getElementById('resultsSection').classList.remove('hidden');
                    processLoader.classList.add('hidden');
                    processBtnText.textContent = 'Process Files';
                    updateProcessButton();
                }, 1000);

            } catch (error) {
                console.error('Processing error:', error);
                alert('Error processing files: ' + error.message);
                progressSection.classList.add('hidden');
                processLoader.classList.add('hidden');
                processBtnText.textContent = 'Process Files';
                updateProcessButton();
            }
        }

        // Update progress
        function updateProgress(percent, status) {
            document.getElementById('progressBar').style.width = percent + '%';
            document.getElementById('progressPercent').textContent = percent + '%';
            document.getElementById('progressStatus').textContent = status;
        }

        // Read Excel file
        async function readExcelFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        
                        const result = {
                            mainData: {},
                            chartData: []
                        };

                        // Read main data sheet
                        const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                        const mainData = XLSX.utils.sheet_to_json(firstSheet);
                        
                        if (mainData.length > 0) {
                            result.mainData = mainData[0];
                        }

                        // Read chart data sheet
                        if (workbook.SheetNames.length > 1) {
                            const chartSheet = workbook.Sheets['ChartData'];
                            if (chartSheet) {
                                const chartData = XLSX.utils.sheet_to_json(chartSheet);
                                result.chartData = chartData;
                            }
                        }

                        resolve(result);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.readAsArrayBuffer(file);
            });
        }

        // Read PowerPoint template (simplified)
        async function readPowerPointTemplate(file) {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    // For now, we'll create a simple template
                    resolve({
                        slides: [
                            { type: 'title', placeholders: ['{project_title}', '{name}'] },
                            { type: 'content', placeholders: ['{status_update}'] },
                            { type: 'agenda', placeholders: ['{agenda}'] }
                        ]
                    });
                };
                reader.readAsArrayBuffer(file);
            });
        }

        // Create simple presentation (HTML-based)
        async function createSimplePresentation(data) {
            const zip = new JSZip();
            
            // Create a simple HTML presentation that can be opened in PowerPoint
            const htmlContent = createHTMLPresentation(data);
            
            // Add files to ZIP
            zip.file('presentation.html', htmlContent);
            zip.file('data.json', JSON.stringify(data, null, 2));
            
            // Generate README
            const readme = `Generated Presentation
=====================

This presentation was generated by Presentr - PowerPoint AutoFill.

Data:
${JSON.stringify(data, null, 2)}

To view this presentation:
1. Open presentation.html in a web browser
2. Copy and paste the content into PowerPoint
3. Or use the "Insert > HTML" feature in PowerPoint

Generated on: ${new Date().toLocaleString()}
`;
            zip.file('README.txt', readme);

            return zip;
        }

        // Create HTML presentation
        function createHTMLPresentation(data) {
            const mainData = data.mainData || {};
            const chartData = data.chartData || [];

            return `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>${mainData.project_title || 'Presentation'}</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .slide { page-break-after: always; min-height: 100vh; }
        .title { font-size: 48px; text-align: center; margin-bottom: 50px; }
        .subtitle { font-size: 24px; text-align: center; color: #666; }
        .content { font-size: 18px; margin: 20px 0; }
        .chart { margin: 30px 0; text-align: center; }
        .agenda-item { margin: 15px 0; font-size: 20px; }
        @media print {
            .slide { page-break-after: always; }
        }
    </style>
</head>
<body>
    <!-- Slide 1: Title -->
    <div class="slide">
        <h1 class="title">${mainData.project_title || 'Project Title'}</h1>
        <p class="subtitle">Status Report prepared by: ${mainData.name || 'Presenter'}</p>
        <p class="subtitle">${new Date().toLocaleDateString()}</p>
    </div>

    <!-- Slide 2: Overview -->
    <div class="slide">
        <h1 class="title">Overview</h1>
        <div class="content">${mainData.status_update || 'Status update will appear here.'}</div>
    </div>

    <!-- Slide 3: Agenda -->
    <div class="slide">
        <h1 class="title">Agenda</h1>
        <div class="agenda-item">‚Ä¢ ${mainData.agenda || 'Agenda items will appear here.'}</div>
    </div>

    <!-- Slide 4: Charts -->
    <div class="slide">
        <h1 class="title">${mainData.ChartTitle || 'Charts'}</h1>
        <div class="chart">
            <p>Chart data has been processed:</p>
            <pre>${JSON.stringify(chartData, null, 2)}</pre>
        </div>
    </div>
</body>
</html>`;
        }

        // Download buttons setup
        function setupDownloadButtons() {
            // Download generated presentation
            document.getElementById('downloadBtn').addEventListener('click', () => {
                if (generatedPresentation) {
                    generatedPresentation.generateAsync({ type: 'blob' }).then((blob) => {
                        saveAs(blob, 'generated_presentation.zip');
                    });
                }
            });

            // Download sample PowerPoint
            document.getElementById('downloadSamplePPT').addEventListener('click', () => {
                createSamplePowerPoint();
            });

            // Download sample Excel
            document.getElementById('downloadSampleExcel').addEventListener('click', () => {
                createSampleExcel();
            });
        }

        // Create sample PowerPoint (HTML)
        async function createSamplePowerPoint() {
            const zip = new JSZip();
            
            const sampleHTML = `
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Sample Presentation</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .slide { page-break-after: always; min-height: 100vh; }
        .title { font-size: 48px; text-align: center; margin-bottom: 50px; }
        .subtitle { font-size: 24px; text-align: center; color: #666; }
        .content { font-size: 18px; margin: 20px 0; }
        .placeholder { background-color: #ffffcc; padding: 10px; border: 1px dashed #999; }
    </style>
</head>
<body>
    <div class="slide">
        <h1 class="title">{project_title}</h1>
        <p class="subtitle">Status Report prepared by: {name}</p>
        <p class="subtitle">{date}</p>
    </div>
    
    <div class="slide">
        <h1 class="title">Overview</h1>
        <div class="placeholder">{status_update}</div>
    </div>
    
    <div class="slide">
        <h1 class="title">Agenda</h1>
        <div class="placeholder">{agenda}</div>
    </div>
    
    <div class="slide">
        <h1 class="title">{ChartTitle}</h1>
        <div class="placeholder">Charts will be generated here based on your Excel data</div>
    </div>
</body>
</html>`;

            zip.file('sample_template.html', sampleHTML);
            zip.file('README.txt', 'Sample PowerPoint Template\n========================\n\nThis is a sample template with placeholders.\nPlaceholders will be replaced with data from your Excel file.\n\nPlaceholders:\n- {project_title}\n- {name}\n- {date}\n- {status_update}\n- {agenda}\n- {ChartTitle}\n');

            zip.generateAsync({ type: 'blob' }).then((blob) => {
                saveAs(blob, 'sample_powerpoint.zip');
            });
        }

        // Create sample Excel
        async function createSampleExcel() {
            const zip = new JSZip();
            
            // Create sample data
            const sampleData = {
                mainData: {
                    name: 'zinab',
                    project_title: 'DGE Review',
                    status_update: 'All financial models have been updated, and the initial report draft is complete. We are on schedule for the board meeting next week.',
                    agenda: 'Technology Stack System Context Design Decisions Mobile Application Features',
                    ChartTitle: 'Analysis of Key Metrics'
                },
                chartData: [
                    { ChartTitle: 'Quarterly Sales', ChartType: 'bar', Series: 'Q1', Label: '', Value: '150' },
                    { ChartTitle: 'Quarterly Sales', ChartType: 'bar', Series: 'Q2', Label: '', Value: '200' },
                    { ChartTitle: 'Engagement Metrics', ChartType: 'line', Series: 'Likes', Label: 'Jan', Value: '1200' },
                    { ChartTitle: 'Engagement Metrics', ChartType: 'line', Series: 'Likes', Label: 'Feb', Value: '1800' },
                    { ChartTitle: 'Engagement Metrics', ChartType: 'line', Series: 'Shares', Label: 'Jan', Value: '400' },
                    { ChartTitle: 'Engagement Metrics', ChartType: 'line', Series: 'Shares', Label: 'Feb', Value: '500' }
                ]
            };

            zip.file('sample_data.json', JSON.stringify(sampleData, null, 2));
            zip.file('README.txt', 'Sample Excel Data\n================\n\nThis file contains sample data for testing the PowerPoint auto-fill application.\n\nThe data includes:\n- Main presentation data\n- Chart data for visualizations\n\nYou can use this data with the sample PowerPoint template.');

            zip.generateAsync({ type: 'blob' }).then((blob) => {
                saveAs(blob, 'sample_excel_data.zip');
            });
        }
    </script>
</body>
</html>